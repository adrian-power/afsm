---
title: "Australian fungi, slime moulds and the people who find them"
subtitle: "AFSM Volume 6 - to end of 2022"
author: "Adrian Power [**adrian_aus**](https://www.inaturalist.org/people/adrian_aus/)"
date: "`r format(Sys.time(), '%d %B %Y')`"

output:
  pdf_document:
    toc_depth: 1
    extra_dependencies: booktabs
  word_document:
    toc_depth: '1'
header-includes:
- \usepackage[default]{sourcesanspro}
- \usepackage[T1]{fontenc}
#https://bookdown.org/yihui/rmarkdown-cookbook/figure-placement.html
- \renewcommand{\topfraction}{.85}
- \renewcommand{\bottomfraction}{.7}
- \renewcommand{\textfraction}{.15}
- \renewcommand{\floatpagefraction}{.66}
- \setcounter{topnumber}{3}
- \setcounter{bottomnumber}{3}
- \setcounter{totalnumber}{4}

mainfont: LiberationSans
geometry: margin=1.5cm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 


##############################################################
#       Resources
##############################################################
# fonts - https://babichmorrowc.github.io/post/changing-fonts-in-rmarkdown-pdfs/
#       - https://stackoverflow.com/questions/50539913/fonts-for-rmarkdown-document
# bookdown - https://bookdown.org/yihui/rmarkdown-cookbook/
# landscape - https://stackoverflow.com/questions/25849814/rstudio-rmarkdown-both-portrait-and-landscape-layout-in-a-single-pdf
# chunk size options: available options for size in descending order are:
#   Huge > huge > LARGE > Large > large > normalsize > small > footnotesize > scriptsize > tiny
# clean ggmaps - https://rpubs.com/Mentors_Ubiqum/ggplot_remove_elements
# whitespace- https://en.wikibooks.org/wiki/LaTeX/Floats,_Figures_and_Captions 
# 
# FORMAT CODE in R Studio - CTRL + SHIFT + A
#
##############################################################
#       GET PACKAGES
##############################################################

# tinytex::install_tinytex() # required for r markdown to work

setwd("C:/Users/Adrian/Desktop/Mush/Analysis")

library(RMySQL)
library(kableExtra) #table formatting
library(dplyr)
library(scales)
library(ggmap)
library(ggforce)

##############################################################
#       GET DATA - mysql
#
# https://www.tutorialspoint.com/r/r_database.htm 
# https://cran.r-project.org/web/packages/RMySQL/RMySQL.pdf
#
# List the tables available in this database: dbListTables(mysqlconnection)
# List all connections - dbListConnections( dbDriver( drv = "MySQL"))
#
##############################################################

# connect to database 
mysqlconnection = dbConnect(
                            MySQL(), 
                            user = 'root', 
                            password = 'mushroom', 
                            dbname = 'fungi',
                            host = 'localhost'
                            )

#aus_ranker 
aus_ranker_db <- dbSendQuery(mysqlconnection, "select * from aus_ranker")
aus_ranker = fetch(aus_ranker_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(aus_ranker_db)
dbClearResult(aus_ranker_db)
rm(aus_ranker_db)

#obs_os
os_obs_db <- dbSendQuery(mysqlconnection, "select * from os_obs")
os_obs = fetch(os_obs_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(os_obs_db)
dbClearResult(os_obs_db)
rm(os_obs_db)

#os_species_summary
os_species_summary_db <- dbSendQuery(mysqlconnection, "select * from os_species_summary")
os_species_summary = fetch(os_species_summary_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(os_species_summary_db)
dbClearResult(os_species_summary_db)
rm(os_species_summary_db)

#obs_final
obs_final_db <- dbSendQuery(mysqlconnection, "select * from obs_final")
obs_final = fetch(obs_final_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(obs_final_db)
dbClearResult(obs_final_db)
rm(obs_final_db)

#protozoa obs
obs_final_db_protozoa <- dbSendQuery(mysqlconnection, "select * from obs_final where taxon_kingdom_name = 'Protozoa' ")
obs_final_protozoa = fetch(obs_final_db_protozoa, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(obs_final_db_protozoa)
dbClearResult(obs_final_db_protozoa)
rm(obs_final_db_protozoa)

#fungi obs
obs_final_db_fungi <- dbSendQuery(mysqlconnection, "select * from obs_final where taxon_kingdom_name = 'Fungi' ")
obs_final_fungi = fetch(obs_final_db_fungi, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(obs_final_db_fungi)
dbClearResult(obs_final_db_fungi)
rm(obs_final_db_fungi)

#obs final FP
obs_final_db_fp <- dbSendQuery(mysqlconnection, "select * from obs_final where taxon_kingdom_name = 'Fungi' or taxon_kingdom_name = 'Protozoa' ")
obs_final_fp = fetch(obs_final_db_fp, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(obs_final_db_fp)
dbClearResult(obs_final_db_fp)
rm(obs_final_db_fp)

#rg stats
rg_species_rank_db <- dbSendQuery(mysqlconnection, "select * from rg_species_rank where taxon_kingdom_name = 'Fungi' or taxon_kingdom_name = 'Protozoa' ")
rg_species_rank = fetch(rg_species_rank_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(rg_species_rank_db)
dbClearResult(rg_species_rank_db)
rm(rg_species_rank_db)

#rg kingdom
rg_kingdom_db <- dbSendQuery(mysqlconnection, "select * from rg_kingdom where taxon_kingdom_name = 'Fungi' or taxon_kingdom_name = 'Protozoa' ")
rg_kingdom = fetch(rg_kingdom_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(rg_kingdom_db)
dbClearResult(rg_kingdom_db)
rm(rg_kingdom_db)

#null counter
null_counter_db <- dbSendQuery(mysqlconnection, "select * from null_counter where taxon_kingdom_name = 'Fungi' or taxon_kingdom_name = 'Protozoa' ")
null_counter = fetch(null_counter_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(null_counter_db)
dbClearResult(null_counter_db)
rm(null_counter_db)

#null counter
loc_kingdom_db <- dbSendQuery(mysqlconnection, "select * from loc_kingdom")
loc_kingdom = fetch(loc_kingdom_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(loc_kingdom_db)
dbClearResult(loc_kingdom_db)
rm(loc_kingdom_db)

#RTS_Ghost
rts_ghost_db <- dbSendQuery(mysqlconnection, "select * from rts_ghost")
rts_ghost = fetch(rts_ghost_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(rts_ghost_db)
dbClearResult(rts_ghost_db)
rm(rts_ghost_db)

#RTS_Ghost
rts_ghost_overlap_db <- dbSendQuery(mysqlconnection, "select * from rts_ghost_overlap")
rts_ghost_overlap = fetch(rts_ghost_overlap_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(rts_ghost_overlap_db)
dbClearResult(rts_ghost_overlap_db)
rm(rts_ghost_overlap_db)

#first find
first_find_db <- dbSendQuery(mysqlconnection, "select * from first_find")
first_find = fetch(first_find_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(first_find_db)
dbClearResult(first_find_db)
rm(first_find_db)

#first obs
first_obs_db <- dbSendQuery(mysqlconnection, "select * from first_obs")
first_obs = fetch(first_obs_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(first_obs_db)
dbClearResult(first_obs_db)
rm(first_obs_db)

#obs_count
obs_count_db <- dbSendQuery(mysqlconnection, "select * from obs_count")
obs_count = fetch(obs_count_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(obs_count_db)
dbClearResult(obs_count_db)
rm(obs_count_db)

#obs_and_id_top_50
obs_and_id_top_50_db <- dbSendQuery(mysqlconnection, "select * from obs_and_id_top_50")
obs_and_id_top_50 = fetch(obs_and_id_top_50_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(obs_and_id_top_50_db)
dbClearResult(obs_and_id_top_50_db)
rm(obs_and_id_top_50_db)

#id_summary_stats
id_summary_stats_db <- dbSendQuery(mysqlconnection, "select * from id_summary_stats")
id_summary_stats = fetch(id_summary_stats_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(id_summary_stats_db)
dbClearResult(id_summary_stats_db)
rm(id_summary_stats_db)

#data_dates
data_dates_db <- dbSendQuery(mysqlconnection, "select * from data_dates")
data_dates = fetch(data_dates_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(data_dates_db)
dbClearResult(data_dates_db)
rm(data_dates_db)

#opf_cumulative_total
opf_cumulative_total_db <- dbSendQuery(mysqlconnection, "select * from opf_cumulative_total")
opf_cumulative_total = fetch(opf_cumulative_total_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(opf_cumulative_total_db)
dbClearResult(opf_cumulative_total_db)
rm(opf_cumulative_total_db)

#opf_map
opf_map_db <- dbSendQuery(mysqlconnection, "select * from opf_map")
opf_map = fetch(opf_map_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(opf_map_db)
dbClearResult(opf_map_db)
rm(opf_map_db)

#state stats
state_stats_db <- dbSendQuery(mysqlconnection, "select * from state_stats")
state_stats = fetch(state_stats_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(state_stats_db)
dbClearResult(state_stats_db)
rm(state_stats_db)

#myxo_tree
myxo_tree_db <- dbSendQuery(mysqlconnection, "select * from myxo_tree")
myxo_tree = fetch(myxo_tree_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(myxo_tree_db)
dbClearResult(myxo_tree_db)
rm(myxo_tree_db)

#point heat reduced fungi
point_heat_fungi_db <- dbSendQuery(mysqlconnection, "select * from point_heat_fungi")
point_heat_fungi = fetch(point_heat_fungi_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(point_heat_fungi_db)
dbClearResult(point_heat_fungi_db)
rm(point_heat_fungi_db)

#point heat reduced protozoa
point_heat_protozoa_db <- dbSendQuery(mysqlconnection, "select * from point_heat_protozoa")
point_heat_protozoa = fetch(point_heat_protozoa_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(point_heat_protozoa_db)
dbClearResult(point_heat_protozoa_db)
rm(point_heat_protozoa_db)

#fungi map 1 analysis
fungimap_1_analysis_db <- dbSendQuery(mysqlconnection, "select * from fungimap_1_analysis")
fungimap_1_analysis = fetch(fungimap_1_analysis_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_1_analysis_db)
dbClearResult(fungimap_1_analysis_db)
rm(fungimap_1_analysis_db)

#fungi map 1 prop
fungimap_1_prop_db <- dbSendQuery(mysqlconnection, "select * from fungimap_1_prop")
fungimap_1_prop = fetch(fungimap_1_prop_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_1_prop_db)
dbClearResult(fungimap_1_prop_db)
rm(fungimap_1_prop_db)

#fungi map 1 prop
fungimap_1_prop_spec_db <- dbSendQuery(mysqlconnection, "select * from fungimap_1_prop_spec")
fungimap_1_prop_spec = fetch(fungimap_1_prop_spec_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_1_prop_spec_db)
dbClearResult(fungimap_1_prop_spec_db)
rm(fungimap_1_prop_spec_db)

#fungi map 2 analysis
fungimap_2_analysis_db <- dbSendQuery(mysqlconnection, "select * from fungimap_2_analysis")
fungimap_2_analysis = fetch(fungimap_2_analysis_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_2_analysis_db)
dbClearResult(fungimap_2_analysis_db)
rm(fungimap_2_analysis_db)

#fungi map 2 prop
fungimap_2_prop_db <- dbSendQuery(mysqlconnection, "select * from fungimap_2_prop")
fungimap_2_prop = fetch(fungimap_2_prop_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_2_prop_db)
dbClearResult(fungimap_2_prop_db)
rm(fungimap_2_prop_db)

#fungi map 2 prop SPEC
fungimap_2_prop_spec_db <- dbSendQuery(mysqlconnection, "select * from fungimap_2_prop_spec")
fungimap_2_prop_spec = fetch(fungimap_2_prop_spec_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_2_prop_spec_db)
dbClearResult(fungimap_2_prop_spec_db)
rm(fungimap_2_prop_spec_db)

#fungi map 2 analysis protozoa
fungimap_2_analysis_protozoa_db <- dbSendQuery(mysqlconnection, "select * from fungimap_2_analysis_protozoa")
fungimap_2_analysis_protozoa = fetch(fungimap_2_analysis_protozoa_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_2_analysis_protozoa_db)
dbClearResult(fungimap_2_analysis_protozoa_db)
rm(fungimap_2_analysis_protozoa_db)

#fungi map 2 prop protozoa
fungimap_2_prop_protozoa_db <- dbSendQuery(mysqlconnection, "select * from fungimap_2_prop_protozoa")
fungimap_2_prop_protozoa = fetch(fungimap_2_prop_protozoa_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_2_prop_protozoa_db)
dbClearResult(fungimap_2_prop_protozoa_db)
rm(fungimap_2_prop_protozoa_db)

#fungi map 2 prop SPEC protozoa
fungimap_2_prop_spec_protozoa_db <- dbSendQuery(mysqlconnection, "select * from fungimap_2_prop_spec_protozoa")
fungimap_2_prop_spec_protozoa = fetch(fungimap_2_prop_spec_protozoa_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(fungimap_2_prop_spec_protozoa_db)
dbClearResult(fungimap_2_prop_spec_protozoa_db)
rm(fungimap_2_prop_spec_protozoa_db)

#protozoa_fungi_users
protozoa_fungi_users_db <- dbSendQuery(mysqlconnection, "select * from protozoa_fungi_users")
protozoa_fungi_users = fetch(protozoa_fungi_users_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(protozoa_fungi_users_db)
dbClearResult(protozoa_fungi_users_db)
rm(protozoa_fungi_users_db)

#users_cumulative
users_cumulative_total_db <- dbSendQuery(mysqlconnection, "select * from users_cumulative_total")
users_cumulative_total = fetch(users_cumulative_total_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(users_cumulative_total_db)
dbClearResult(users_cumulative_total_db)
rm(users_cumulative_total_db)

#obs_cumulative
obs_cumulative_total_db <- dbSendQuery(mysqlconnection, "select * from obs_cumulative_total")
obs_cumulative_total = fetch(obs_cumulative_total_db, n = -1) # n=-1 returns all records, default = 500 rows
dbHasCompleted(obs_cumulative_total_db)
dbClearResult(obs_cumulative_total_db)
rm(obs_cumulative_total_db)


#close all connections 
#dbDisconnect(fungi)
lapply(dbListConnections(dbDriver(drv = "MySQL")), dbDisconnect)
rm(mysqlconnection)


##########################################
###   TRANSFORMATIONS ###
##########################################

#make date fields dates (transform in place)

obs_final <- obs_final %>%
  mutate(obs_final, observed_on = as.Date(observed_on, format= "%Y-%m-%d")) %>%
  mutate(obs_final, observed_on_month = as.Date(observed_on_month, format= "%Y-%m-%d")) %>%
  mutate(obs_final, created_at = as.Date(created_at, format= "%Y-%m-%d"))

obs_final_fp <- obs_final_fp %>%
  mutate(obs_final_fp, observed_on = as.Date(observed_on, format= "%Y-%m-%d")) %>%
  mutate(obs_final_fp, observed_on_month = as.Date(observed_on_month, format= "%Y-%m-%d")) %>%
  mutate(obs_final_fp, created_at = as.Date(created_at, format= "%Y-%m-%d"))
  
obs_final_fungi <- obs_final_fungi %>%
  mutate(obs_final_fungi, observed_on = as.Date(observed_on, format= "%Y-%m-%d")) %>%
  mutate(obs_final_fungi, observed_on_month = as.Date(observed_on_month, format= "%Y-%m-%d")) %>%
  mutate(obs_final_fungi, created_at = as.Date(created_at, format= "%Y-%m-%d")) %>%
  mutate(obs_final_fungi, created_month = as.Date(created_month, format= "%Y-%m-%d")) 

obs_final_protozoa <- obs_final_protozoa %>%
  mutate(obs_final_protozoa, observed_on = as.Date(observed_on, format= "%Y-%m-%d")) %>%
  mutate(obs_final_protozoa, observed_on_month = as.Date(observed_on_month, format= "%Y-%m-%d")) %>%
  mutate(obs_final_protozoa, created_at = as.Date(created_at, format= "%Y-%m-%d")) %>%
  mutate(obs_final_protozoa, created_month = as.Date(created_month, format= "%Y-%m-%d"))
  
first_obs <- first_obs %>%
  mutate(first_obs, created_month = as.Date(created_month, format = "%Y-%m-%d"))

obs_count <- obs_count %>%
  mutate(obs_count, observed_on_month = as.Date(observed_on_month, format = "%Y-%m-%d"))

opf_cumulative_total <- opf_cumulative_total %>%
  mutate(opf_cumulative_total, observed_on_month = as.Date(observed_on_month, format = "%Y-%m-%d"))

users_cumulative_total <- users_cumulative_total %>%
  mutate(users_cumulative_total, aggr_month = as.Date(aggr_month, format = "%Y-%m-%d"))

obs_cumulative_total <- obs_cumulative_total %>%
  mutate(obs_cumulative_total, aggr_month = as.Date(aggr_month, format = "%Y-%m-%d"))


#Aus Ranker Tables

aus_ranker_protozoa_table <- aus_ranker %>%
  filter(taxon_kingdom_name == "Protozoa") %>%
  filter(obs_rank < 51) %>%
  select(user_login, obs_rank, obs, obs_prop, species_rank, species, species_prop, research_count, research_ratio, IDs, ID_rank) %>%
  arrange(obs_rank,user_login) %>%
  head(50)

aus_ranker_protozoa_table$obs_prop <- percent(aus_ranker_protozoa_table$obs_prop, accuracy = 0.1)
aus_ranker_protozoa_table$species_prop <- percent(aus_ranker_protozoa_table$species_prop, accuracy = 0.1)
aus_ranker_protozoa_table$research_ratio <- percent(aus_ranker_protozoa_table$research_ratio, accuracy = 0.1)

myxo_tree$RG_Prop <- percent(myxo_tree$RG_Prop, accuracy = 0.1)

aus_ranker_fungi_table <- aus_ranker %>%
  filter(taxon_kingdom_name == "Fungi") %>%
  filter(obs_rank < 51) %>%
  select(user_login, obs_rank, obs, obs_prop, species_rank, species, species_prop, research_count, research_ratio, IDs, ID_rank) %>%
  arrange(obs_rank,user_login) %>%
  head(50)

rg_species_rank_2 <- rg_species_rank %>%
  filter(scientific_name != "unknown")

rg_species_rank_3 <- rg_species_rank %>%
  filter(scientific_name != "unknown") %>%
  filter(obs_count > 100) %>%
  arrange(desc(spec_rg_prop)) %>%
  head(25)

first_find_fungi <- first_find %>%
  filter(taxon_kingdom_name == "Fungi") %>%
  select(fo_row, scientific_name, total) %>%
  head(25)

first_find_protozoa <- first_find %>%
  filter(taxon_kingdom_name == "Protozoa") %>%
  select(fo_row, scientific_name, total) %>%
  head(25)



#create a reduced set of points for better heat maps and to reduce PDF file size (by reducing the number of points to plot per file)
obs_final_fungi_reduced <- obs_final_fungi %>%
                          mutate(across(7:8, round, 1))%>% 
                          select(latitude,longitude, observed_season)

#create a reduced set of points for better heat maps
obs_final_protozoa_reduced <- obs_final_protozoa %>%
                          mutate(across(7:8, round, 1))%>% 
                          select(latitude,longitude, observed_season)


#convert certain fields to percentages
aus_ranker_fungi_table$obs_prop <- percent(aus_ranker_fungi_table$obs_prop, accuracy = 0.1)
aus_ranker_fungi_table$species_prop <- percent(aus_ranker_fungi_table$species_prop, accuracy = 0.1)
aus_ranker_fungi_table$research_ratio <- percent(aus_ranker_fungi_table$research_ratio, accuracy = 0.1)

rg_kingdom$rg_prop <- percent(rg_kingdom$rg_prop, accuracy = 0.1)
rg_species_rank_3$spec_rg_prop <- percent(rg_species_rank_3$spec_rg_prop, accuracy = 0.1)

null_counter$species_guess <- percent(null_counter$species_guess, accuracy = 0.1)
null_counter$scientific_name <- percent(null_counter$scientific_name, accuracy = 0.1)
null_counter$common_name <- percent(null_counter$common_name, accuracy = 0.1)
null_counter$taxon_phylum_name <- percent(null_counter$taxon_phylum_name, accuracy = 0.1)
null_counter$taxon_class_name <- percent(null_counter$taxon_class_name, accuracy = 0.1)
null_counter$taxon_order_name <- percent(null_counter$taxon_order_name, accuracy = 0.1)
null_counter$taxon_genus_name <- percent(null_counter$taxon_genus_name, accuracy = 0.1)
null_counter$taxon_species_name <- percent(null_counter$taxon_species_name, accuracy = 0.1)

loc_kingdom$LOC_Prop_Fungi <- percent(loc_kingdom$LOC_Prop_Fungi, accuracy = 0.1)
loc_kingdom$LOC_Prop_Protozoa <- percent(loc_kingdom$LOC_Prop_Protozoa, accuracy = 0.1)

obs_and_id_top_50$Prop_Top_50_Ids_in_Top_50_Obs <- percent(obs_and_id_top_50$Prop_Top_50_Ids_in_Top_50_Obs, accuracy = 0.1)

id_summary_stats$Highest_User_Prop_Total <- percent(id_summary_stats$Highest_User_Prop_Total, accuracy = 0.01)

fungimap_1_analysis$RG_Prop <- percent(fungimap_1_analysis$RG_Prop, accuracy = 0.1)
fungimap_1_prop$FM1_Prop <- percent(fungimap_1_prop$FM1_Prop, accuracy = 0.1)
fungimap_1_prop_spec$FM1_Prop <- percent(fungimap_1_prop_spec$FM1_Prop, accuracy = 0.1)

protozoa_fungi_users$Prop_AFO <- percent(protozoa_fungi_users$Prop_AFO, accuracy = 0.1)

fungimap_2_analysis$RG_Prop <- percent(fungimap_2_analysis$RG_Prop, accuracy = 0.1)
fungimap_2_prop$FM2_Prop <- percent(fungimap_2_prop$FM2_Prop, accuracy = 0.1)
fungimap_2_prop_spec$FM2_Prop <- percent(fungimap_2_prop_spec$FM2_Prop, accuracy = 0.1)

fungimap_2_analysis_protozoa$RG_Prop <- percent(fungimap_2_analysis_protozoa$RG_Prop, accuracy = 0.1)
fungimap_2_prop_protozoa$FM2_Prop <- percent(fungimap_2_prop_protozoa$FM2_Prop, accuracy = 0.1)
fungimap_2_prop_spec_protozoa$FM2_Prop <- percent(fungimap_2_prop_spec_protozoa$FM2_Prop, accuracy = 0.1)


##############################################################
#       GET MAP DATA
##############################################################

# plot Australia map - GG MAP
sbbox <- make_bbox(lon = c(115, 157),
                   lat = c(-42,-13),
                   f = .1)
# get map
aus_map_gg = get_map(
  location = sbbox,
  zoom = 6,
  source = "osm",
  maptype = "terrain"
)
# create map
ausmap = ggmap(aus_map_gg) +
  theme(
    legend.position = "none",
    panel.grid = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    plot.margin = unit(c(0, 0, 0, 0), 'lines')
  )


#################
# RTS ghost map
# plot map - GG MAP
bidj_sbbox <-
  make_bbox(
    lon = c(150.97, 151.04),
    lat = c(-33.795,-33.74),
    f = .1
  )
# get map
bidj_map_gg = get_map(
  location = bidj_sbbox,
  zoom = 14,
  source = "osm",
  maptype = "terrain"
)
# create map
bidjmap = ggmap(bidj_map_gg) +
  theme(
    legend.position = "none",
    panel.grid = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    plot.margin = unit(c(0, 0, 0, 0), 'lines')
  )

#################
#world map
library(tidyverse)  # has map_data (world)

world <- map_data("world")

png(
  filename = "world_map_fungi.png",
  width = 2000,
  height = 1000,
  units = "px",
  pointsize = 4,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)

ggplot() +
  geom_map(
    data = world,
    map = world,
    aes(long, lat, map_id = region),
    color = "darkgray",
    fill = "white",
    size = 0.2
  ) +
  geom_point(
    data = os_obs,
    aes(longitude_reduced, latitude_reduced, colour = region),
    alpha = 0.7,
    size = 0.05
  ) +
  theme_void() +
  theme(legend.position = "none") #was "none"

dev.off()



#################
#### MAP IMAGES
#################

png(
  filename = "protozoa_heat_point.png",
  width = 2000,
  height = 1600,
  units = "px",
  pointsize = 2,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)
ausmap +
  geom_point(
    data = point_heat_protozoa,
    mapping = aes(x = longitude_reduced, y = latitude_reduced, colour = Obs),
    cex = .01,
    pch = 20
  ) +
  scale_colour_gradient(low = "blue", high = "red")
dev.off()


png(
  filename = "protozoa_heat.png",
  width = 1000,
  height = 800,
  units = "px",
  pointsize = 4,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)
ausmap +
  stat_density2d(
    aes(
      x = longitude,
      y = latitude,
      fill = ..level..,
      alpha = I(.2)
    ),
    bins = 500,
    geom = "polygon",
    data = obs_final_protozoa_reduced
  ) +
  scale_fill_gradient(low = "blue", high = "red")
dev.off()


png(
  filename = "protozoa_dist.png",
  width = 1000,
  height = 800,
  units = "px",
  pointsize = 4,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)
ausmap +
  geom_point(
    data = obs_final_protozoa,
    mapping = aes(x = longitude, y = latitude),
    col = "darkblue",
    cex = .01,
    pch = 20
  )
dev.off()


png(
  filename = "fungi_heat_point.png",
  width = 2000,
  height = 1600,
  units = "px",
  pointsize = 2,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)
ausmap +
  geom_point(
    data = point_heat_fungi,
    mapping = aes(x = longitude_reduced, y = latitude_reduced, colour = Obs),
    cex = .01,
    pch = 20
  ) +
  scale_colour_gradient(low = "blue", high = "red")
dev.off()


png(
  filename = "fungi_heat.png",
  width = 1000,
  height = 800,
  units = "px",
  pointsize = 4,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)
ausmap +
  stat_density2d(
    aes(
      x = longitude,
      y = latitude,
      fill = ..level..,
      alpha = I(.2)
    ),
    bins = 500,
    geom = "polygon",
    data = obs_final_fungi_reduced
  ) +
  scale_fill_gradient(low = "blue", high = "red")
dev.off()


png(
  filename = "fungi_dist.png",
  width = 1000,
  height = 800,
  units = "px",
  pointsize = 4,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)
ausmap +
  geom_point(
    data = obs_final_fungi,
    mapping = aes(x = longitude, y = latitude),
    col = "darkblue",
    cex = .01,
    pch = 20
  )
dev.off()


png(
  filename = "rts_ghost.png",
  width = 2000,
  height = 1600,
  units = "px",
  pointsize = 1,
  bg = "white",
  res = 300,
  type = c("cairo-png")
)
ausmap +
  geom_point(
    data = rts_ghost_overlap,
    mapping = aes(x = longitude_reduced_4, y = latitude_reduced_4, colour = Overlap),
    cex = .3,
    pch = 20
  ) + scale_color_manual(values = c(
    "Ghost Only" = "black",
    "RTS Only" = "red",
    "Both" = "yellow"
  ))
dev.off()


##### image sizing options #####
  #####![unchanged image](protozoa_heat.png)
  #####![much-smaller image](Rplo03d.png){#id .class width=30 height=20px}
  #####![half-size image](Rplo03d.png){#id .class width=50% height=50%}

```


\newpage 
\footnotesize
\tableofcontents 

\newpage 
\footnotesize
## Changes and additions 
**Volume 6 (to 2022-12-28)**  
* Added international observation comparison  

**Volume 5 (to 2022-08-31)**  
* Added Fungimap flags to the Top species by proportion of research grade observations  
* Added Protozoa breakdown in Fungimap 2 section  
* Added level of completeness (LOC) table, so it is easier to compare changes over time  
* Corrected chart title: Frequency distribution of species by research grade proportion  

**Volume 4 (to 2022-06-30)**  
* Added the proportion of observations that are research grade by month created  
* Added the proportion of observations by taxon level of completeness (LOC)  
* Added the proportion of Fungimap 1 and 2 observations of all species level observations  

**Volume 3 (to 2022-06-30)**  
* Added the Fungimap original and version 2 target species analysis  
* Added the cumulative total of observations and users  
* Improved charts  

**Volume 2 (to 2022-05-31)**  
* Added the Mycetozoa (observed) family tree  
* Added IDs to the Top 50 Obs tables  
* Added Red Triangle Slugs to Bidjigal map and added overlap analysis for Red Triangle Slug and Ghost Fungus distribution  
* Improved map quality and halved file size  

**Volume 1 (to 2022-03-27)**  

## Introduction - Australian fungi, slime moulds and the people who find them

This document brings together some interesting insights about fungi and protozoa that are not available from iNaturalist directly. It can be downloaded from [https://adrianpower.com/](https://adrianpower.com/). Volume 1 was shared by the Australian Mycological Society in their April 2022 newsletter.

The insights highlight the value and potential of citizen science to contribute to an evidence base to help understand a subject that is literally and figuratively 'in the dark'. My favourite insight is that the top 50 observers of fungi on iNaturalist represent only `r round(50 / n_distinct(obs_final_fungi$user_id)*100, digits = 2)`% of all users, yet their observations contribute almost half (`r round((sum(aus_ranker[which(aus_ranker$taxon_kingdom_name=='Fungi' & aus_ranker$obs_rank_cat=='Top 50'), 5]) / nrow(na.omit(obs_final_fungi)))*100, digits = 2)`%) of the total observations. This shows that one person *can* make a world of difference to the information available about fungi and protozoa in Australia. 

Adrian Power


\newpage 
\footnotesize

## Background and aim - an exploration of iNaturalist fungi and protozoa data
My interest in fungi took off while bushwalking in April 2019 where in just a few kilometres I saw an incredible array of different fungi. I was so surprised by the variety, I bought the Field Guide to Australian Fungi (Bruce Fuhrer, 2016) and tried to identify them from the photos I took. The guide opened my eyes to an even larger world of fungi and from that point I was hooked. I quickly learnt how to take better photos for identification purposes and even created a page on [my website](https://adrianpower.com/) (now removed) to catalogue my observations. It had square cropped photos with a small description in a grid layout - I didn't realise at the time that I had created a D-I-Y iNaturalist page. 

In late 2021 [I came across what I thought might have been an orange slime mould that I could not identify](https://www.inaturalist.org/observations/90105506) and contacted Sarah Lloyd for assistance, who kindly suggested I might be interested in iNaturalist. From that point on life has never been the same. By using iNaturalist I have become even more aware of the sheer variety of fungi out there and a better observer in the field. I also became acutely aware of the stark lack of documented species and reference material. 

The more I contributed to iNaturalist, the more I wondered how the data collected is being used. I did a little research yet couldn't find much information except for FungiMap. Though I don't have any biology training, I do have a background in data and analytics and decided to look at the iNaturalist data for myself, to see what I could see. 

What started out as a little data exploration has morphed into this document - a mix of ideas for how iNaturalist data can be used. Sometimes even simple ideas can provide compelling insights. Initially I wanted to understand distributions of species but became even more interested in the human factor: what drives people to post their observations and how citizen science contributes to an evidence base. 

Looking into the people side of things acknowledges the contributions of those who have added to the data. Though every contribution is valuable, there are a few avid users who have significantly impacted the amount and quality of data available. This document aims to celebrate those contributions. 

I aim to release updates of this document regularly (seasonally) and incorporate improvements and additions as I go. This document has been coded in the R and SQL programming languages so it can update automatically. 

I have included a couple of interests of mine: documenting the distribution of fungi and protozoa in Bidjigal Reserve (Sydney, Aus) and a little about Red Triangle Slugs and Ghost Fungus. Some people might find it strange that I have mixed kingdoms - i.e. fungi and protozoa. I believe these go hand in hand in that they happen to take up residence in similar locations. If I can help raise the profile of slime moulds even a little, I consider that a success.

I hope you enjoy reading this as much as I enjoyed putting it together. Please let me know if you have any feedback or suggestions for future versions. Message me on [iNaturalist](https://www.inaturalist.org/people/adrian_aus/), or email fungi@adrianpower.com  

## iNaturalist, Australian data and limitations
This document explores observations and identifications of fungi and protozoa in Australia. [iNaturalist](https://www.inaturalist.org/) is where I contribute observations and the website makes it easy to download the data I want to analyse. It is also recommended by [FungiMap](https://fungimap.org.au/). I am aware of the [iNaturalist and Atlas of Living Australia (ALA) collaboration](https://www.ala.org.au/blogs-news/ala-inaturalist-collaboration/) but have not explored the ALA data.  

The iNaturalist data for observations is well structured, with minimal data cleansing required. 'Casual' observations are excluded (as these are missing a valid date or location). Non-research grade observations are important contributions to the evidence base and analysing these highlights the need for people to review and accurately identify observations.  

Contributions to identifications are as important as the observations themselves. Unfortunately, there is currently no way to export detailed information about identification activity, but some summary statistics have been explored.  

**A note about iNaturalist species**  
When looking at an iNaturalist user's observations, there is a species count at the top of the page. There appears to be no 'raw' data available from iNaturalist that corresponds exactly to the iNaturalist species counts. For example, the following fields and their counts have been compared: species_guess, scientific_name, common_name, iconic_taxon_name and taxon_species_name. As such, the species related counts in this document do not always match what is displayed on the iNaturalist website, and so I have minimised the amount of species ranking. There is limited information on how exactly the iNaturalist species counts are calculated, for background see: https://www.inaturalist.org/posts/19369-how-does-inaturalist-count-taxa. 

The data fields used in this document to calculate species counts are scientific_name or species_name, depending on the analysis.

```{r nulls, echo=FALSE}

knitr::kable(
  null_counter,
  longtable = TRUE,
  caption = 'Proportion of fields that are missing values',
  "latex",
  align = "lcccccccc",
  linesep = "",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Kingdom',
    'Species Guess',
    'Scientific Name',
    'Common Name',
    'Phylum',
    'Class',
    'Order',
    'Genus',
    'Species Name'
  )
)

```

```{r loc_kingdom, echo=FALSE}

knitr::kable(
  loc_kingdom,
  longtable = TRUE,
  caption = 'Proportion of fields by Kingdom and Level Of Completeness (LOC)',
  "latex",
  align = "llclc",
  linesep = "",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c('LOC',
                'Fungi Obs',
                'Fungi LOC %',
                'Protozoa Obs',
                'Protozoa LOC %')
)

```


\newpage
\footnotesize

## General observations and exploration of the data
As of iNaturalist data to 
`r max(obs_final_fungi$observed_on, na.rm = TRUE)`
, there are 
`r format(nrow(na.omit(obs_final_fungi)), scientific=F, big.mark=",")` 
observations of fungi in Australia, from 
`r format(n_distinct(obs_final_fungi$user_id), scientific=F, big.mark=",")`
observers and as of 
`r max(obs_final_protozoa$observed_on, na.rm = TRUE)`
, there are 
`r format(nrow(na.omit(obs_final_protozoa)), scientific=F, big.mark=",")` 
observations of protozoa in Australia, from 
`r format(n_distinct(obs_final_protozoa$user_id), scientific=F, big.mark=",")`
observers.  

### Seasonal distribution of observations 

iNaturalist shows the seasonality for each species on the site by month, however seeing observations aggregated to the level of kingdom and phylum by season reveals broad trends.   
```{r seasonal_distibution_f, echo=FALSE, fig.height = 2}

obs_final_fungi_2 <- obs_final_fungi

obs_final_fungi_2$observed_season <-
  factor (
    obs_final_fungi_2$observed_season,
    levels = c("4. Summer", "3. Spring", "2. Winter", "1. Autumn"),
    ordered = TRUE
  )

ggplot(obs_final_fungi_2,
       aes(y = observed_season, fill = taxon_phylum_name)) +
  geom_bar() + 
  theme(aspect.ratio = 2 / 6) + 
  labs(title = "Fungi: Total observations by Season and Phylum", x = element_blank(), y = element_blank()) + labs(fill = "Phylum") 

```

```{r seasonal_distibution_p, echo=FALSE, fig.height = 2}

obs_final_protozoa_2 <- obs_final_protozoa

obs_final_protozoa_2$observed_season <-
  factor (
    obs_final_protozoa_2$observed_season,
    levels = c("4. Summer", "3. Spring", "2. Winter", "1. Autumn"),
    ordered = TRUE
  )

ggplot(obs_final_protozoa_2,
       aes(y = observed_season, fill = taxon_phylum_name)) +
  geom_bar() + 
  theme(aspect.ratio = 2 / 6) + 
  labs(title = "Protozoa: Total observations by Season and Phylum", x = element_blank(), y = element_blank()) + labs(fill = "Phylum")

```

### Time between observation and uploading

Often people create observations in the field with the iNaturalist app. Sometimes they become interested in fungi and upload photos from 10 years ago. This chart explores the 'lag' between when something was observed VS when the iNaturalist entry was created. There can be a negative lag, sometimes the entry is created before the observation date. This might be for various reasons, such as the adjustment of dates by photo editing software or differences in time zones, or simply a result of incorrect data entry.  

On average, observations on iNaturalist are posted `r round(mean(obs_final_fp$created_lag, na.rm = TRUE), digits = 0)` days after they were seen in the wild, with a maximum of `r format(round(max(obs_final_fp$created_lag, na.rm = TRUE), digits = 0), scientific=F, big.mark=",")`, a minimum of `r round(min(obs_final_fp$created_lag, na.rm = TRUE), digits = 0)` and a median of `r round(median(obs_final_fp$created_lag, na.rm = TRUE), digits = 0)`.

```{r lag_cat, echo=FALSE, fig.height = 2}

ggplot(
  obs_final_fp,
  aes(y = taxon_kingdom_name, fill = created_lag_cat),
  options(scipen = 999)
) +
  geom_bar() + 
  theme(aspect.ratio = 2 / 6) + 
  labs(title = "Days between observing and uploading", x = 'Observations', y = element_blank()) + 
  labs(fill = "Lag") +  
  scale_x_continuous(breaks = seq(0, 350000, by = 70000))

```


\newpage
\footnotesize

### Total observations per month
The following chart shows the total number of observations per month by kingdom. 

```{r total_obs, echo=FALSE, fig.align='center', fig.height = 4}

ggplot(data = obs_count,
       aes(x = observed_on_month, y = Obs, color = taxon_kingdom_name)) +
  geom_line(size = 1) + 
  labs(x = 'Date Observed', y = 'Total observations per month', colour = 'Kingdom') +   
  scale_y_continuous(breaks = seq(0, (max(obs_count$Obs)), by = 2000)) + 
  scale_x_date(date_breaks = "5 years", date_labels = "%Y") + 
  scale_color_manual(values = c("Fungi" = "dodgerblue", "Protozoa" = "darkorchid"))

```

### Cumulative total of observations
```{r cum_obs_1, echo=FALSE, fig.align='center', fig.height = 4}

ggplot(
  data = obs_cumulative_total,
  aes(
    x = aggr_month,
    y = Cumulative_Total,
    group = taxon_kingdom_name,
    colour = taxon_kingdom_name
  )
) + geom_line(size = 1) + 
  labs(x = 'Date Observed', y = 'Cumulative total of obs', colour = "Kingdom")  + 
  scale_y_continuous(breaks = seq(0, (max(obs_cumulative_total$Cumulative_Total)), by = 20000)) + scale_x_date(date_breaks = "5 years", date_labels = "%Y") + 
  scale_color_manual(values = c("Fungi" = "dodgerblue", "Protozoa" = "darkorchid"))

```


\newpage
\footnotesize

### New observers per month
This chart shows the number of new observers per month, based on their first observation date. It would be interesting to look into peaks of interest and whether it correlates with seasons, or events such as bio-blitzes or the release of "Fantastic Fungi" on Netflix. 2020 was clearly a turning point for fungi and protozoa - perhaps this is related to COVID-19 lockdowns and people getting more outdoor exercise.

```{r first_obs_new_users_trend, echo=FALSE, fig.align='center', fig.height = 4}

ggplot(data = first_obs, aes(x = created_month, y = Obs, color = taxon_kingdom_name)) +
  geom_line(size = 1) + 
  labs(x = 'First Observation Created', y = 'Total users per month', colour = 'Kingdom') + 
  scale_y_continuous(breaks = seq(0, (max(first_obs$Obs)), by = 100)) + 
  scale_x_date(date_breaks = "2 years", date_labels = "%Y") + 
  scale_color_manual(values = c("Fungi" = "dodgerblue", "Protozoa" = "darkorchid"))

```

### Cumulative total of observers
Based on the earliest observation created date.
```{r cum_users_1, echo=FALSE, fig.align='center', fig.height = 4}

ggplot(
  data = users_cumulative_total,
  aes(
    x = aggr_month,
    y = Cumulative_Total,
    group = taxon_kingdom_name,
    colour = taxon_kingdom_name
  )
) + geom_line(size = 1) + 
  labs(x = 'First Observation Created', y = 'Cumulative total of users', colour = "Kingdom")  + 
  scale_y_continuous(breaks = seq(0, (max(users_cumulative_total$Cumulative_Total)), by = 1000)) + scale_x_date(date_breaks = "2 years", date_labels = "%Y") + 
  scale_color_manual(values = c("Fungi" = "dodgerblue", "Protozoa" = "darkorchid"))

```


\newpage
\footnotesize

### Research Grade Analysis
Thanks to [Sequoia Lewien](https://www.inaturalist.org/people/sequoia_l) for the idea to look at the species that have high proportions of research grade records. A far higher number of species do not have any research grade observations, which is probably a reflection of the limited number of experts actively contributing to the site for identifications, and that to get a positive ID, often microscopy or DNA sequencing is required. Sometimes people simply upload photos that can't be used for identification, due to being blurry or missing important surfaces or features. It's quite interesting that the RG proportion by kingdom is so similar. In the table below, FM (and version) indicates a FungiMap target species. 

```{r kingdom_rg, echo=FALSE}
knitr::kable(
  rg_kingdom,
  caption = 'Research Grade Observations by Kingdom',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "lccc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c('Kingdom',
                'RG Count',
                'Obs Count',
                'RG Prop.')
)

```
  
```{r top_RG, echo=FALSE}
knitr::kable(
  rg_species_rank_3,
  longtable = TRUE,
  caption = 'Top 25 species by proportion of research grade observations with more than 100 observations',
  "latex",
  align = "llccccc",
  linesep = "",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Kingdom',
    'Scientific Name',
    'RG Count',
    'Obs Count',
    'RG Prop.',
    'FM 1',
    'FM 2'
  )
)
```
   
### Frequency distribution of species by research grade proportion (scientific name) 
```{r dist_rg_spec, echo=FALSE, fig.height = 3}
ggplot(rg_species_rank_2, aes(x=spec_rg_prop)) + 
  geom_histogram() + 
  theme(aspect.ratio=1/6) + 
  labs(x='Proportion of research grade observations', y='Species Count') 

```


\newpage
\footnotesize

### Proportion of observations that are research grade by month created
Thanks to [Tom May](https://www.inaturalist.org/people/funkeytom) for this suggestion.

```{r rg_prop_mth_fungi, echo=FALSE, fig.align='center'}
ggplot(obs_final_fungi, aes(x = created_month, fill = quality_grade)) +
  geom_bar(position = "fill") + 
  theme(aspect.ratio=4/6) + 
  labs(title = "Proportion of RG observations by month created - Fungi", x = element_blank(), y = element_blank())  + 
  scale_x_date(date_breaks = "1 year",date_labels = "%Y") + 
  scale_fill_manual(values = c("needs_id" = "dodgerblue1", "research" = "dodgerblue4")) + 
  labs(fill = "Quality Grade")
```

```{r rg_prop_mth_protozoa, echo=FALSE, fig.align='center'}
ggplot(obs_final_protozoa, aes(x = created_month, fill = quality_grade)) +
  geom_bar(position = "fill") + 
  theme(aspect.ratio=4/6) + 
  labs(title = "Proportion of RG observations by month created - Protozoa", x = element_blank(), y = element_blank())  + 
  scale_x_date(date_breaks = "1 year",date_labels = "%Y") + 
  scale_fill_manual(values = c("needs_id" = "darkorchid1", "research" = "darkorchid4")) + 
  labs(fill = "Quality Grade")
```


\newpage
\footnotesize

### Proportion of observations by taxon Level Of Completeness (LOC)
Level Of Completeness (LOC) meaning the lowest level of taxon recorded for each observation. Thanks to [Tom May](https://www.inaturalist.org/people/funkeytom) for this suggestion.

```{r loc_prop_fungi, echo=FALSE, fig.align='center'}

ggplot(obs_final_fungi, aes(x = created_month, fill = loc)) +
  geom_bar(position = "fill") + 
  theme(aspect.ratio=4/6) + 
  labs(title = "Proportion of observations by LOC by month created - Fungi", x = element_blank(), y = element_blank())  + 
  scale_x_date(date_breaks = "1 year",date_labels = "%Y") + 
  scale_fill_brewer(palette = 'Blues', direction = -1) + 
  labs(fill = "LOC")

```
 
```{r loc_prop_protozoa, echo=FALSE, fig.align='center'}
ggplot(obs_final_protozoa, aes(x = created_month, fill = loc)) +
  geom_bar(position = "fill") + 
  theme(aspect.ratio=4/6) + 
  labs(title = "Proportion of observations by LOC by month created - Protozoa", x = element_blank(), y = element_blank())  + 
  scale_x_date(date_breaks = "1 year",date_labels = "%Y") + 
  scale_fill_brewer(palette = 'Purples', direction = -1) + 
  labs(fill = "LOC")
```


\newpage
\footnotesize

### First Find
What species first captures someone's attention enough to lead to their first observation for fungi and protozoa? Note: the aggregation is based on the lowest level of taxon recorded (scientific name).

```{r first_find_protozoa, echo=FALSE}
knitr::kable(
  first_find_fungi,
  caption = 'First find - Fungi',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "clc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c('Rank',
                'Scientific Name',
                'Count')
)

```

```{r first_find_fungi, echo=FALSE}
knitr::kable(
  first_find_protozoa,
  caption = 'First find - Protozoa',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "clc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c('Rank',
                'Scientific Name',
                'Count')
)

```


\newpage
\footnotesize

## Bidjigal Reserve - a secret valley
Bidjigal Reserve is a hidden sanctuary in the north-west of Sydney that is an important place to me and is named after the Bidjigal people who are the traditional custodians. I highly recommend you read this incredible overview, ["The bushland of Bidjigal Reserve and adjoining reserves"](https://archive.org/details/Bidjigal_Reserve), which points out on page 7 that the reserve is known for its diversity of Fungi.

**A place to preserve**  
I hope drawing attention to this area will help its preservation. There are some pristine areas in the reserve, which are maintained through many dedicated local bush care groups both past and present. But it is not perfect. Until the 1970's, when the surrounding area was bulldozed for housing and sewer lines installed along the many creek-lines, the area had crystal clear water which was home to platypus. The area is under pressure, with many sections plagued by weeds, vandalism, rubbish and over-use. The creek lines are often contaminated by sewage overflow. Bidjigal reserve needs coordinated and active management, which sadly is not occurring. It is a beautiful place, home to many plants and animals, including echidna.

**The project**  
When I started on iNaturalist, there were very few records of fungi in this area so I set about changing that through [**my project, "The Fungi and Slime Moulds of The Hills District, especially Bidjigal Reserve and Northmead Gully in Sydney, Australia"**](https://www.inaturalist.org/projects/fungi-and-slime-moulds-of-the-hills-district-esp-bidjigal-reserve). You can help by reviewing identifications on the project page or by visiting the reserve and contributing observations.  

**The variety**  
With an incredible diversity of habitats and vegetation communities comes an abundance of varieties of fungi, including (at the time of writing) the southern-most recorded Green Pepe (*Mycena chlorophos*) in Australia. I suspect there are species unique to this area or that are undescribed to science. Without microscopy or DNA sequencing, these species will remain a mystery. 

```{r bidj_ng_map, echo=FALSE, fig.align='center', out.width='100%', fig.cap="The recorded distribution of fungi (blue), slime moulds (purple) and Red Triangle Slugs (red) in Bidjigal Reserve, Northmead Gully and surrounding areas"}
# display map
bidjmap +
  geom_point(data = obs_final,
             mapping = aes(x = longitude, y = latitude, colour = taxon_kingdom_name),
             cex = 1.25,
             pch = 20
             
  ) + scale_color_manual(values = c("Fungi" = "dodgerblue", "Protozoa" = "darkorchid", "Animalia" = "brown1"))

```


\newpage
\footnotesize

## The recorded distribution of Red Triangle Slugs and Ghost Fungus in Australia

*Omphalotus nidiformis*, commonly known as Ghost Fungus, is bio-luminescent and endemic to Australia. Anyone who has seen it glow in the dark will be captivated by its eerie beauty and there are plenty of great long-exposure photos on iNaturalist. 

I wondered why it glows. Is it to attract insects who might spread its spores? A quick look on [Wikipedia](https://en.wikipedia.org/wiki/Omphalotus_nidiformis) shows Ghost Fungus has, "been observed to attract nocturnal insects such as beetles, native cockroaches and crickets (white-kneed cricket (*Papuastus spp.*) and thorny cricket), as well as giant rainforest snails (*Hedleyella falconeri*) and red triangle slugs (*Triboniophorus graeffei*), which voraciously consume the fungus" ([13],[35]).

*Triboniophorus graeffei*, commonly known as Red Triangle Slugs are large, air breathing land slugs also endemic to Australia, and equally as captivating with their bright red triangle. One thing I find fascinating is that often in nature, patterns are symmetrical, yet with this slug, the triangle is not.

I wanted to know how closely distributed these two species are. The location data for the map below has been aggregated to [4 decimal places](https://en.wikipedia.org/wiki/Decimal_degrees), which groups the observations into approximately 10 m x 10 m areas. Based on the data to date, there are `r format(length(which(rts_ghost_overlap$Overlap=="Ghost Only")), scientific=F, big.mark=",")` areas with only Ghost Fungus observations, `r format(length(which(rts_ghost_overlap$Overlap=="RTS Only")), scientific=F, big.mark=",")` areas with only Red Triangle Slug observations and just `r format(length(which(rts_ghost_overlap$Overlap=="Both")), scientific=F, big.mark=",")` areas with both.

![Recorded distribution (in ~10 m^2 areas) of Red Triangle Slugs (red), Ghost Fungus (black) and both (yellow)](rts_ghost.png){#id .class width=60% height=60%}

```{r ghost_data_quality, echo=FALSE, fig.align='center', out.height='30%'}
ggplot(rts_ghost, aes(y = scientific_name, fill = quality_grade)) +
  geom_bar() + theme(aspect.ratio=1/6) + 
  labs(title = "Data quality - Red Triangle Slug and Ghost Fungus", x = element_blank(), y = element_blank()) + labs(fill = "Quality Grade")
```

**Source:** https://en.wikipedia.org/wiki/Omphalotus_nidiformis: [13] Maguire, Garry (9 December 2011). "Luminous Ghost Fungus". Springbrook, Queensland: Springbrook Research Centre. [35] Young, T. (1996). "Some more records of fungi used as food by animals in Australia" (PDF). Australasian Mycologist. 15 (1): 89.

\newpage
\footnotesize

## The recorded distribution of fungi in Australia

As of iNaturalist data to: `r max(obs_final_fungi$observed_on, na.rm = TRUE)`

The dots on the map below represent the approximate location of observations, with each dot representing an area of [approximately 10 km x 10 km](https://en.wikipedia.org/wiki/Decimal_degrees). A colour change from blue to red represents an increase in observations in an area.  

![Fungi Distribution Map](fungi_heat_point.png)


\newpage
\footnotesize
## The top 50 observers of fungi in Australia
As of iNaturalist data to: 
`r max(obs_final_fungi$observed_on, na.rm = TRUE)`
, there are 
`r format(nrow(na.omit(obs_final_fungi)), scientific=F, big.mark=",")` 
observations of fungi in Australia, from 
`r format(n_distinct(obs_final_fungi$user_id), scientific=F, big.mark=",")`
observers. Each user represents 
`r round(1 / n_distinct(obs_final_fungi$user_id)*100, digits = 3)`% of the total. The Top 50 users contributed 
`r  format(sum(aus_ranker[which(aus_ranker$taxon_kingdom_name=='Fungi' & aus_ranker$obs_rank_cat=='Top 50'), 5]), scientific=F, big.mark=",")`
 observations, or 
`r round((sum(aus_ranker[which(aus_ranker$taxon_kingdom_name=='Fungi' & aus_ranker$obs_rank_cat=='Top 50'), 5]) / nrow(na.omit(obs_final_fungi)))*100, digits = 2)`% of the total, while representing only 
`r round(50 / n_distinct(obs_final_fungi$user_id)*100, digits = 2)`% of total observers. This page celebrates the contribution these users have made to the data available.

```{r top_50_fungi, echo=FALSE}

knitr::kable(
  aus_ranker_fungi_table,
  longtable = TRUE,
  caption = 'Top 50 observers of fungi in Australia',
  "latex",
  align = "lrlcrlccc",
  linesep = "",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'User',
    'Obs Rank',
    'Obs',
    'Obs %',
    'Species Rank',
    'Species ^',
    'Species %',
    'RG',
    'RG Ratio',
    'IDs',
    'ID Rank #'
  )
)

```

**Notes - For each user in the list:**  

* Obs Rank: based on the number of observations. If there is a tie for positions, users are sorted alphabetically
* Obs: the number of observations
* Obs %: the proportion of observations by the user compared to the total observations of all users
* Species Rank: based on the total number of species observed (distinct taxon_species_name) 
* Species: the count of distinct taxon_species_name for each observer **^ N.B. this will not match the count on iNaturalist (the reason is explained in this document)**
* Species %:  the proportion of species observed by the user compared to the the total of all species with observations recorded from all users
* RG: the number of research grade observations
* RG Ratio: the proportion of research grade observations
* IDs and ID Rank (#): based on the Top 500 identifiers per kingdom. See the Identifications section for more detail.


\newpage
\footnotesize

## The recorded distribution of protozoa in Australia 

As of iNaturalist data to: `r max(obs_final_protozoa$observed_on, na.rm = TRUE)`

The dots on the map below represent the approximate location of observations, with each dot representing an area of [approximately 10 km x 10 km](https://en.wikipedia.org/wiki/Decimal_degrees). A colour change from blue to red represents an increase in observations in an area.  

![Protozoa Distribution Map](protozoa_heat_point.png)


\newpage
\footnotesize
## The top 50 observers of protozoa in Australia
As of iNaturalist data to: 
`r max(obs_final_protozoa$observed_on, na.rm = TRUE)`
, there are 
`r format(nrow(na.omit(obs_final_protozoa)), scientific=F, big.mark=",")` 
observations of protozoa in Australia, from 
`r format(n_distinct(obs_final_protozoa$user_id), scientific=F, big.mark=",")`
observers. Each user represents 
`r round(1 / n_distinct(obs_final_protozoa$user_id)*100, digits = 3)`% of the total. The Top 50 users contributed 
`r  format(sum(aus_ranker[which(aus_ranker$taxon_kingdom_name=='Protozoa' & aus_ranker$obs_rank_cat=='Top 50'), 5]), scientific=F, big.mark=",")`
 observations, or 
`r round((sum(aus_ranker[which(aus_ranker$taxon_kingdom_name=='Protozoa' & aus_ranker$obs_rank_cat=='Top 50'), 5]) / nrow(na.omit(obs_final_protozoa)))*100, digits = 2)`% of the total, while representing only 
`r round(50 / n_distinct(obs_final_protozoa$user_id)*100, digits = 2)`% of total observers. This page celebrates the contribution these users have made to the data available.

```{r top_50_protozoa, echo=FALSE}

knitr::kable(
  aus_ranker_protozoa_table,
  longtable = TRUE,
  caption = 'Top 50 observers of protozoa in Australia',
  "latex",
  align = "lrlcrlccc",
  linesep = "",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'User',
    'Obs Rank',
    'Obs',
    'Obs %',
    'Species Rank',
    'Species ^',
    'Species %',
    'RG',
    'RG Ratio',
    'IDs',
    'ID Rank #'
  )
)

```

**Notes - For each user in the list:**    

* Obs Rank: based on the number of observations. If there is a tie for positions, users are sorted alphabetically
* Obs: the number of observations
* Obs %: the proportion of observations by the user compared to the total observations of all users
* Species Rank: based on the total number of species observed (distinct taxon_species_name) 
* Species: the count of distinct taxon_species_name for each observer **^ N.B. this will not match the count on iNaturalist (the reason is explained in this document)**
* Species %:  the proportion of species observed by the user compared to the the total of all species with observations recorded from all users
* RG: the number of research grade observations
* RG Ratio: the proportion of research grade observations
* IDs and ID Rank (#): based on the Top 500 identifiers per kingdom. See the Identifications section for more detail.


\newpage
\footnotesize

## Observers by State

```{r state_stats, echo=FALSE}
x <- knitr::kable(
  state_stats,
  caption = 'Summary of users by state',
  longtable = TRUE,
  linesep = "",
  align = "llcc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c('Kingdom',
                'State',
                'Total Users',
                'Total Obs')
)
collapse_rows(x)

```

## Identifications
The work people put into identifications on iNaturalist is just as important as the observations. Although there isn't a way to extract the complete identifications data to allow for a detailed analysis, there are some summary statistics available on the site.  iNaturalist lists the top 500 users for identifications per kingdom. The top user below refers to the user with the highest number of identifications per kingdom.

```{r id_summary_stats, echo=FALSE}
knitr::kable(
  id_summary_stats,
  caption = 'Summary statistics for top the 500 identifiers by Kingdom',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "lccccc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Kingdom',
    'Total Users',
    'Total IDs',
    'Average IDs',
    'Top user IDs',
    'Top user % of Top 500 user IDs'
  )
)

```

Are the users in the Top 50 Observers the same as the Top 50 Identifiers? Not as much as I anticipated.  

```{r obs_and_id_top_50, echo=FALSE}
knitr::kable(
  obs_and_id_top_50,
  caption = 'Proportion of Top 50 Observers who are also Top 50 Identifiers',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "lc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c('Kingdom',
                'Proportion')
)

```

## Protozoa and fungi observers
As there are relatively few Protozoa observations and observers compared to those of Fungi, I looked at the proportion of Protozoa observers who also observe Fungi, to understand whether they are predominately the same people. 

```{r protozoa_fungi_users, echo=FALSE}
knitr::kable(
  protozoa_fungi_users,
  caption = 'Proportion of Protozoa observers who also observe Fungi',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "ccc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Protozoa Observers',
    'Protozoa and Fungi Observers',
    'Proportion of both'
  )
)

```


\newpage
\footnotesize

## Orange Pore Fungus   
Orange Pore Fungus is an introduced invasive species. I consider it the *Lantana* of fungi in Australia. iNaturalist data can be used to track the spread of this species. It is easy to identify and as such has a high proportion of research grade observations. Between the 24th and 25th of March 2022, after the data for Volume 1 was analysed, a [taxon split occurred on iNaturalist](https://www.inaturalist.org/taxon_changes/107833) based on [https://doi.org/10.3390/f12101397](https://doi.org/10.3390/f12101397). This means that *Favolaschia calocera*, was swapped with *Favolaschia claudopus*. The impact of that change meant that many observations required a huge amount of effort from the community to restore the species level IDs. The common name of Orange Pore Fungus has been transferred to *Favolaschia claudopus*.  
Note (#): for the time being, logic has been applied to include all observations from the genus Favolaschia,  specifically excluding *F. manipularis* and *F. pustulosa* (the only other species with observations in Australia) and as such includes all observations entered under Complex *Favolaschia calocera*, in recognition that it will take time for users to become aware of the change. 

### Cumulative total of Orange Pore Fungus(#) observations in Australia   

```{r opf_obs, echo=FALSE, fig.align='center', fig.height = 3}

ggplot(data = opf_cumulative_total, aes(x=observed_on_month, y=Cumulative_Total)) +
  geom_line(size = 2, color = 'darkorange1' ) + 
  theme(aspect.ratio=2/6) + labs(x='Month Observed', y='Cumulative total of observations') + 
  scale_y_continuous(breaks=seq(0,(max(opf_cumulative_total$Cumulative_Total)), by = 200)) + 
  scale_x_date(date_breaks = "2 years",date_labels = "%Y")

```
### Recorded distribution of Orange Pore Fungus(#) in Australia   

```{r opf_map, echo=FALSE, fig.align='center', out.width='75%'}
# display map
ausmap +
  geom_point(
    data = opf_map,
    mapping = aes(x = longitude_reduced, y = latitude_reduced, colour = 'darkorange3'),
    cex = .5,
    pch = 20
  ) + facet_wrap( ~ Date_Range)

```


\newpage
\footnotesize

## The Mycetozoa (observed) family tree  
This table shows the number of observations for each branch of the Mycetozoa phylum (of the Protozoa kingdom) tree: *class > order > genus*. Branches of the tree without observations are not included.

```{r myxo_tree_1, echo=FALSE}

knitr::kable(
  myxo_tree,
  caption = 'Mycetozoa (observed) family tree',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "lcccc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Mycetozoa Tree: Class > Order > Genus',
    'Branch Obs',
    'Species',
    'Branch RG',
    'RG %'
  )
)

```


\newpage
\footnotesize

## Fungimap target species - original
[Fungimap](https://fungimap.org.au/) is "a not for profit, citizen-science organisation dedicated to furthering the conservation and knowledge of Australian fungi and started in 1995 as a mapping project". Please visit the [Fungimap site](https://fungimap.org.au/) and support their work if you can.  

Of the `r format(nrow(na.omit(obs_final_fungi)), scientific=F, big.mark=",")` observations of fungi in Australia, `r format(max(fungimap_1_prop$FM1), scientific=F, big.mark=",")` or `r fungimap_1_prop$FM1_Prop` are of an original Fungimap target species.  

Of the `r format(max(fungimap_1_prop_spec$Total), scientific=F, big.mark=",")` **species level** observations of fungi in Australia, `r format(max(fungimap_1_prop_spec$FM1), scientific=F, big.mark=",")` or `r fungimap_1_prop_spec$FM1_Prop` are of an original Fungimap target species. 

The 100 original Fungimap target species are detailed below. Note: Some target species are groups of multiple species; I have initially included only the most common species of those groups. Please let know any specific species that should be included in this list.

```{r fungimap_1_analysis, echo=FALSE}
knitr::kable(
  fungimap_1_analysis,
  caption = 'Fungimap Original Target Species',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "llllclc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Class > Order > Genus',
    'Scientific Name',
    'RG',
    'Obs',
    'RG %',
    'Users',
    'States / Territories'
  )
)

```

## Fungimap - Fungi Down Under 2 target species 
Fungimap is working on their second target species list [https://fungimap.org.au/fungi-down-under-100-target-species/fungi-down-under-2/](https://fungimap.org.au/fungi-down-under-100-target-species/fungi-down-under-2/). The list below includes the species as of 2022-06-20 and interestingly will include several slime moulds! 

**Fungi**: Of the `r format(nrow(na.omit(obs_final_fungi)), scientific=F, big.mark=",")` observations of fungi in Australia, `r format(max(fungimap_2_prop$FM2), scientific=F, big.mark=",")` or `r fungimap_2_prop$FM2_Prop` are of a Fungimap version 2 target species.
Of the `r format(max(fungimap_2_prop_spec$Total), scientific=F, big.mark=",")` **species level** observations of fungi in Australia, `r format(max(fungimap_2_prop_spec$FM2), scientific=F, big.mark=",")` or `r fungimap_2_prop_spec$FM2_Prop` are of a Fungimap version 2 target species. 

**Protozoa**: Of the `r format(nrow(na.omit(obs_final_protozoa)), scientific=F, big.mark=",")` observations of protozoa in Australia, `r format(max(fungimap_2_prop_protozoa$FM2), scientific=F, big.mark=",")` or `r fungimap_2_prop_protozoa$FM2_Prop` are of a Fungimap version 2 target species.
Of the `r format(max(fungimap_2_prop_spec_protozoa$Total), scientific=F, big.mark=",")` **species level** observations of protozoa in Australia, `r format(max(fungimap_2_prop_spec_protozoa$FM2), scientific=F, big.mark=",")` or `r fungimap_2_prop_spec_protozoa$FM2_Prop` are of a Fungimap version 2 target species. 

Note: Some target species are groups of multiple species; I have included only the most common species of those groups. Please let know any specific species that should be included in this list, noting this list will be reviewed once Fungimap makes it final.

```{r fungimap_2_analysis_p, echo=FALSE}
knitr::kable(
  fungimap_2_analysis_protozoa,
  caption = 'Fungimap 2 Target Species - PROTOZOA',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "llllclc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Class > Order > Genus',
    'Scientific Name',
    'RG',
    'Obs',
    'RG %',
    'Users',
    'States / Territories'
  )
)

```


\newpage
\footnotesize

```{r fungimap_2_analysis, echo=FALSE}
knitr::kable(
  fungimap_2_analysis,
  caption = 'Fungimap 2 Target Species - FUNGI',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "llllclc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Class > Order > Genus',
    'Scientific Name',
    'RG',
    'Obs',
    'RG %',
    'Users',
    'States / Territories'
  )
)

```


\newpage
\footnotesize

## International species and incorrect identifications
iNaturalist provides identification suggestions, along with those from the community. This functionality is incredibly valuable, however, it is common for these identification suggestions to be incorrect, particularly for fungi. Data quality issues can arise when a user selects a suggestion from the iNaturalist system, which often incorrectly suggests species as 'seen nearby' that actually have not been observed in the country.

If users apply these incorrect identification suggestions to their observations, it can result in incorrect data being added to iNaturalist's database. This can lead to inaccurate or misleading information being shared with other users and researchers, and can also affect the accuracy of research studies that rely on data from iNaturalist. It is important for users to carefully review identification suggestions and seek additional input or confirmation if they are uncertain about the accuracy of the suggestion, and if in doubt, select the Kingdom. 

As incorrect identifications are a common issue that takes the time and effort of the community to rectify, I had the idea to analyse species with IDs that are recorded mostly overseas, so these can be reviewed for accuracy. Both [@allyvan](https://www.inaturalist.org/people/allyvan) and [Tom May](https://www.inaturalist.org/people/funkeytom) supported this idea, making it the most popular feature request for this report. 

Data for the comparison regions includes all research grade (RG) observations from 'East Asia', 'Northern Europe', Canada and New Zealand as of September 2022. A summary of the overlap of species between species is provided below. 

Considering the value this reporting can provide to the community, and due to the large number of species in common, I trialed many approaches to generating lists for review. The first approach compared the proportions of each species to all species in a region, also factoring in the proportion of research grade observations, with the idea being if the proportion of a species in Australia is relatively small compared to other regions, and has a low proportion of research grade observations, it might indicate an incorrect species. However, it was not a reliable method and the resulting list was too long. I then trialed more advanced approaches to calculating the probability of any given species being one found in Australia, based on region, quality grade, genus and seasonality. These results were more promising, although more work needs to be done. 

```{r os_species_comparison_summary, echo=FALSE}
knitr::kable(
  os_species_summary,
  caption = 'Overlap between species (Sp.) observed in Australia and other regions',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "lcccc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c(
    'Region',
    'Region RG Sp.',
    'Sp. in common',
    'Sp. in common that have any RG obs in Aus',
    'Sp. in common without RG obs in Aus'
  )
)

```

![Distribution of fungi observations per specific regions for comparison](world_map_fungi.png)  


\newpage
\footnotesize
## Thanks

Thank you to everyone who has provided feedback and to everyone on iNaturalist. I hope it's motivating to know how your contributions can be used. Your feedback motivates me to keep producing new volumes.

## Future versions

My plan is to update this document regularly, or when there is something interesting to add. Let me know if you have any ideas that can be considered for future versions.  

## Data Source
iNaturalist. Available from https://www.inaturalist.org. Accessed per "Date To" in the table below.

```{r data_dates, echo=FALSE}
knitr::kable(
  data_dates,
  caption = 'iNaturalist data dates for this report (excluding international)',
  "latex",
  longtable = TRUE,
  linesep = "",
  align = "llcc",
  booktabs = TRUE,
  format.args = list(big.mark = ","),
  col.names = c('iNaturalist Data Source',
                'Kingdom',
                'Data From',
                'Data To')
)

```

## Copyright
This work is licensed under a [Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License](http://creativecommons.org/licenses/by-nc-nd/4.0/).

## Contact  
* iNaturalist: **https://www.inaturalist.org/people/adrian_aus/**
* Email: fungi@adrianpower.com
* https://adrianpower.com/ 